{# sidebar-secondary.html #}
{# Approach: Capture component content first, then conditionally render #}
{# This prevents empty sidebar sections from being displayed #}

{% if secondary_sidebar_items -%}
  {% set ns = namespace(has_component_content=false) %}

  {# First pass: check if any sidebar component has content #}
  {% for toc_item in secondary_sidebar_items %}
    {% set component_content %}{% include toc_item %}{% endset %}
    {% if component_content | trim %}
      {% set ns.has_component_content = true %}
    {% endif %}
  {% endfor %}

  {# Check if any extra links sections have content #}
  {% set has_extra_links = extra_project_links or community_links or language_bindings_links or library_links %}

  {# Only render the sidebar container if there's actual content #}
  {% if ns.has_component_content or has_extra_links %}
  <div class="sidebar-secondary-items sidebar-secondary__inner">
    {# Render each component only if it has content #}
    {% for toc_item in secondary_sidebar_items %}
      {% set component_content %}{% include toc_item %}{% endset %}
      {% if component_content | trim %}
        <div class="sidebar-secondary-item">{{ component_content }}</div>
      {% endif %}
    {% endfor %}

{% if extra_project_links %}
<div class="sidebar-secondary-item">
  <div class="sidebar-heading">Quick Links</div>
   <ul style="list-style-type: none; padding: 0;">
     {% for link in extra_project_links %}
       <li><a class="nav-link nav-external" href="{{ link.url }}" style="color: var(--pst-color-text-muted)">{{ link.name }}</a></li>
     {% endfor %}
   </ul>
</div>
{% endif %}
{% if community_links %}
<div class="sidebar-secondary-item">
  <div class="sidebar-heading">PyTorch Community</div>
  <ul style="list-style-type: none; padding: 0;">
  {% for link in community_links %}
     <li><a class="nav-link nav-external" href="{% if link.url.startswith('http') %}{{ link.url }}{% else %}{{ pathto(link.url.lstrip('/')) }}{% endif %}" style="color: var(--pst-color-text-muted)">{{ link.name }}</a></li>
  {% endfor %}
  </ul>
</div>
{% endif %}
{% if language_bindings_links %}
<div class="sidebar-secondary-item">
 <div class="sidebar-heading">Language Bindings</div>
 <ul style="list-style-type: none; padding: 0;">
 {% for link in language_bindings_links %}
   <li><a class="nav-link nav-external" href="{% if link.url.startswith('http') %}{{ link.url }}{% else %}{{ pathto(link.url.lstrip('/')) }}{% endif %}" style="color: var(--pst-color-text-muted)">{{ link.name }}</a></li>
 {% endfor %}
 </ul>
</div>
{% endif %}
{% if library_links %}
<div class="sidebar-secondary-item">
  <div class="sidebar-heading">PyTorch Libraries</div>
  <ul style="list-style-type: none; padding: 0; padding-bottom: 80px;">
  {% for link in library_links %}
   <li><a class="nav-link nav-external" href="{{ link.url }}" style="color: var(--pst-color-text-muted)">{{ link.name }}</a></li>
  {% endfor %}
  </ul>
</div>
{% endif %}
  </div>
  {% endif %}
{% endif %}
