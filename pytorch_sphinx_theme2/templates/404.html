{% extends "!layout.html" %}

{% block extrahead %}
{{ super() }}
<script>
    // Fix static asset paths for 404 page on static hosting
    (function () {
        // Skip on localhost/development
        if (window.location.hostname === 'localhost' ||
            window.location.hostname === '127.0.0.1') {
            return;
        }

        // Get the base path for _static assets
        let basePath = '/';

        // On docs.pytorch.org, use first subdirectory (e.g. /tutorials, /docs) as base
        if (window.location.hostname === 'docs.pytorch.org') {
            const pathParts = window.location.pathname.split('/').filter(part => part);
            if (pathParts.length > 0) {
                basePath = '/' + pathParts[0] + '/';
            }
        }

        // Fix CSS links
        document.querySelectorAll('link[href*="_static"]').forEach(link => {
            if (!link.href.startsWith('http') && !link.href.startsWith('/')) {
                link.href = basePath + link.getAttribute('href');
            }
        });

        // Fix script sources
        document.querySelectorAll('script[src*="_static"]').forEach(script => {
            if (!script.src.startsWith('http') && !script.src.startsWith('/')) {
                script.src = basePath + script.getAttribute('src');
            }
        });

        // Fix image sources
        document.querySelectorAll('img[src*="_static"]').forEach(img => {
            if (!img.src.startsWith('http') && !img.src.startsWith('/')) {
                img.src = basePath + img.getAttribute('src');
            }
        });
    })();
</script>
<!-- Conditional CSS for header and footer height adjustment -->
{% if not theme_show_lf_header or not theme_show_lf_footer %}
<style>
    {
        % if not theme_show_lf_header %
    }

    :root {
        --header-height: 0px !important;
        --header-height-desktop: 0px !important;
    }

        {
        % endif %
    }

        {
        % if not theme_show_lf_footer %
    }

    @media (min-width: 1100px) {
        .site-footer {
            height: 300px !important;
        }
    }

        {
        % endif %
    }
</style>
{% endif %}
{% endblock extrahead %}

{% block body_tag %}

<body data-feedback-url="{{ feedback_url }}" class="pytorch-body">
    {% if theme_show_lf_header %}
    {% include "pytorch_header.html" %}
    {% endif %}
    {{ super() }}
    {% endblock %}

    {% block body %}
    <article class="bd-article" id="pytorch-article">
        <div class="container text-center error-404-container">
            <h1 class="error-404-title">404</h1>
            <h2 class="error-404-subtitle">Page Not Found</h2>
            <p class="error-404-text">The page you are looking for might have been removed, had its name changed, or is
                temporarily unavailable.</p>
            <div class="error-404-buttons">
                <a href="{{ pathto(master_doc) }}" class="btn btn-primary error-404-button">
                    Back Home <i class="fa fa-arrow-right" aria-hidden="true"></i>
                </a>
                <a href="{{ theme_feedback_url|default('https://github.com/pytorch/pytorch') }}/issues/new?template=documentation.yml&labels=module:%20docs,broken-link"
                    class="btn btn-secondary error-404-button error-404-issue-button">
                    Found a broken link? File an issue <i class="fa-brands fa-github" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </article>
    {% endblock body %}

    {% block footer%}
    {% include "pytorch_footer.html" %}
    {{ super() }}
    {% endblock %}
